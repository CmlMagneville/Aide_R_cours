---
title: "Parce que c'est votre projet, utilisez RStudio !"
author: "Camille Magneville & Ga√´l Mariani"
date: "`r Sys.Date()`"
output: 
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# T√©l√©charger R et RStudio

Vous devez d'abord t√©l√©charger :

1. R, c'est ici <https://cloud.r-project.org/>
2. RStudio, c'est l√† <https://rstudio.com/products/rstudio/download/>


# 1. Ouverture de votre fichier Excel

### 1.1 - Enregistrement le fichier de donn√©es au format .csv 
  
Pour ouvrir votre fichier de donn√©es sur RStudio, il faut l'enregistrer dans un format **.csv**. 

‚û• Fichier > Enregistrer sous > Type ==> CSV (s√©parateur : point virgule). 

### 1.2 - Renseigner votre chemin d'acc√®s

Pour que RStudio sache o√π aller chercher votre fichier dans votre ordinateur, il faut lui dire o√π aller. Pour cela, vous devez d√©finir le chemin du r√©pertoire de travail (ou dossier) dans lequel vous allez travailler. <br> 
Deux fa√ßons de faire, √† vous de choisir celle que vous pr√©f√©rez :

1. Via `setwd()`

Vous pouvez utiliser la commande `setwd()` : **set** pour **d√©finir** et **wd** pour **working directory**, r√©pertoire de travail en anglais. 

```{r}
setwd("C:/Users/gael-/Dropbox/PhD/Enseignements/HLBE405")
```

2. Fa√ßon clique bouton 

Aller dans Session > Set Working Directory > Choose Directory ... ou Ctrl+Shift+H. <br>
Aller dans le r√©pertoire de travail o√π se trouve votre fichier de donn√©es. 

### 1.3 - Ouvrir le fichier .csv
Vous allez utiliser la commande `read.csv()`, et lui renseigner trois informations :

1. Le nom de votre fichier avec `file = "le_nom_de_votre_fichier.csv"`.
2. Le type de s√©parateur entre vos colonnes avec `sep = ";"`. Ici vous avez un **;** car vous avez enregistrer votre fichier au format **CSV (s√©parateur : point virgule)**. 
3. Le caract√®re utilis√© dans votre tableau pour rentrer les chiffres d√©cimaux (chiffres √† virgule) avec `dec = "," `. 

```{r}
data <- read.csv(file = "exemple.csv",
                 sep = ";",
                 dec = ",")

head(data)
```

La premi√®re √©tape est termin√©e ! <br>
![Alt Text](https://media.giphy.com/media/vvbGMpbhZMcHSsD50w/giphy.gif)

# 2. Manipulation du tableau de donn√©es.

### 2.1 - S√©lectionner certaines lignes/colonnes. 
Il y a deux fa√ßons de s√©lectionner des lignes/colonnes. Soit en indiquant le num√©ro de la colonne, soit en indiquant le nom de la colonne que vous voulez. 
Dans les deux cas, il faudra utiliser la syntaxe suivante : <br> `nom_tableau[n¬∞ligne, n¬∞colonne]` ou `nom_tableau["nom ligne", "nom colonne"]`. 

**Si vous voulez s√©lectionner la colonne n¬∞2 de votre tableau : **
```{r}
data[, 2]
data[, "traitement"]
data$traitement # le $ est une sorte de raccourci pour dire colonne
```

**Si vous voulez toutes les informations de votre individu n¬∞5 :**
```{r}
data[5, ]
data["5", ]
```

**Si vous voulez s√©lectionner la masse (colonne n¬∞6) de l'individus n¬∞3 : **
```{r}
data[3, 6]
data[3, "poids_animal"]
```

### 2.2 - Ajouter des colonnes

Dans certains cas, vous allez devoir faire de petits calculs, comme la quantit√© de nourriture ing√©r√©e. <br>

Il faut donc dire √† l'ordinateur que vous voulez cr√©er une nouvelle colonne **conso_tot** dans le tableau **data** via `data$conso_tot`. Cette nouvelle colonne est √©gale √† la masse de nourriture avant l'exp√©rience `data$poids_sec_av` moins la masse de nourriture apr√®s l'exp√©rience `data$poids_sec_ap`. <br>
En langage R, √ßa donne :

```{r}
data$conso_tot <- data$poids_sec_av - data$poids_sec_ap
head(data)
```

De la m√™me fa√ßon,vous pouvez calculer la consommation par unit√© de masse :
```{r}
data$conso_masse <- (data$poids_sec_av - data$poids_sec_ap)/data$poids_animal
head(data)
```

# 3. Production des figures

Pour illustrer vos r√©sultats, il existe de multiples types de graphiques!
Sur ce site (<https://www.r-graph-gallery.com/index.html>) vous trouverez de nombreuses id√©es et la fa√ßon de les coder. Pour chaque type de graphique, il y a deux fa√ßons de les coder: soit en utilisant un outil particulier qui s'appelle **ggplot2** soit en codant en **base R** comme on fait depuis le d√©but du tutoriel. Dans un premier temps nous vous recommendons de suivre la version de code **base R** lorsque les deux sont propos√©es üí°
<br>

### 3.1 Produire un nuage de points 

La fonction `plot()` vous permet de construire un nuage de point en utilisant deux colonnes de votre tableau. la syntaxe est la suivante <br>
`plot(x = variable_√†_mettre_en_abscisse, y = variable_√†_mettre_en_ordonn√©es)` .
<br>

De plus, vous pouvez utiliser de multiples arguments afin de changer les couleurs, les formes (etc.) utilis√©es dans le graphique. Par exemple, l'argument `cex`permet de sp√©cifier la taille des symboles utilis√©s, les arguments `xlim` et `ylim` permettent de fixer les limites des axes x et y, les arguments `xlab`et `ylab` permettent de fixer le nom des axes x et y, l'argument `col` permet de fixer la couleur des points (voici une liste des possibles couleurs dans R: <http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf>), l'argument `main` permet de donner un titre au graphique et l'argument `pch{ permet de choisir la forme des points (cercles, carr√©s, losanges...)
<br>

Avec les donn√©es de l'exemple, nous pouvons repr√©senter le nuage de points de la consommation par unit√© de masse en fonction de la masse de nourriture avant l'exp√©rience avant m√™me si ce n'est pas tr√®s int√©ressant (mais pour vous montrer sur un exemple concret comme √ßa se code):

```{r}
plot(x = data$poids_sec_av, y = data$poids_sec_ap,
     xlim = c(0, 8), ylim = c(0, 8), 
     pch = 18, 
     cex = 1, 
     col = "aquamarine3",
     xlab = "Masse nourriture avant", ylab = "Masse nourriture apr√®s",
     main = "Masse de nourriture apr√®s en fonction \n de la masse de nourriture avant l'exp√©rience")

```
<br>

### 3.2 - Ins√©rer une courbe de r√©gression (et calculer un coefficient de corr√©lation)

#### 3.2.1 - Ins√©rer une courbe de r√©gression

Pour cr√©√©r une ligne de r√©gression qui mod√©lise les donn√©es, il faut cr√©er un mod√®le de r√©gression. Ici nous resterons sur les mod√®les lin√©aires (de la forme y = ax + b). 
<br>

Pour cr√©er le mod√®le on utilise la fonction `lm()` (pour **L**inear **M**odel). Sa syntaxe est la suivante:<br>
 `lm(variable_√†_mettre_en_y ~ variable_√†_mettre_en_x)`.
<br>

```{r}
# 1/ on cr√©√© un mod√®le pour voir s'il peut "fitter" les donn√©es?
model <- lm(data$poids_sec_ap ~ data$poids_sec_av)
``` 

Une fois le mod√®le de r√©gression cr√©√©, il faut regarder les propri√©t√©s du mod√®le, notamment combien de variation de la variable que je cherche √† expliquer (celle qui est en y) notre mod√®le explique. On fait √ßa en regardant la valeur du R2. Le R2 exprime **le pourcentage de variation de la variable y expliqu√© par le mod√®le**. Donc plus le R2 est grand, plus le mod√®le explique bien la variation observ√©e  üí° Pour aller chercher la valeur de R2, on utilise la commande <br>
`nom_du_mod√®le$adj.r.squared`<br>

On peut ensuite regarder les coefficients du mod√®le, c'est-√†-dire la valeur de la pente et la valeur de l'ordonn√©e √† l'origine.
<br>

```{r}
# 2/ on regarde les propri√©t√©s de ce mod√®le:

## le R2 qui exprime le pourcentage de variation de y qui est expliqu√© par le mod√®le:
summary(model)$adj.r.squared

## les coefficients du mod√®le c'est √† dire l'ordonn√©e √† l'origine et la pente:
model$coefficients
```

Une fois les prori√©t√©s du mod√®le v√©rifi√©es, on peut afficher la droite de r√©gression en utilisant la fonction `abline()`. L'argument de la fonction est tout simplement le mod√®le cr√©√© pr√©c√©demment avec la fonction `lm`.
<br>

```{r}
# 3/ On peut ensuite refaire le graphique pr√©c√©dent en ajoutant la droite de r√©gression grace √† la fonction abline():
plot(x = data$poids_sec_av, y = data$poids_sec_ap,
     xlim = c(0, 8), ylim = c(0, 8), 
     pch = 18, 
     cex = 1, 
     col = "aquamarine3",
     xlab = "Masse nourriture avant", ylab = "Masse nourriture apr√®s",
     main = "Masse de nourriture apr√®s l'exp√©rience \n en fonction de la masse de nourriture avant")
abline(model, col = "red")
```
<br>

#### 3.2.2 - Calculer un coefficient de corr√©lation

Pour calculer le coefficient de correlation entre deux variables, il faut utiliser la fonction `cor()` suivant la syntaxe suivante:<br>
 `cor(variable_1 , variable_2, method = c("pearson"))`. Ici on utilise un coefficient de pearson car les deux variables √† √©tudier sont continues.<br>

üí° **Correlation n'est pas causalit√©! **

```{r}
cor(data$poids_sec_av, data$poids_sec_ap, method = c("pearson"))
```
<br>

### 3.2 - Produire un histogramme

Pour produire un histogramme, on utilise la fonction `hist()`. Les arguments pour le titre, la couleur et le nom des axes sont les m√™mes que ceux vus dans la partie **3.1**. Vous pouvez choisir de repr√©senter la fr√©quence d'une variable unique comme suit pour la variable de la masse s√®che avant l'exp√©rience:
<br>
```{r}
hist(data$poids_sec_av, col = "aquamarine3", main = "Fr√©quences des masses s√®ches avant", 
     xlab = "masses s√®ches (en g)", ylab = "Fr√©quence")
```
<br>


### 3.3 - Produire des bo√Ætes √† moustaches

Pour cr√©√©r une boite √† moustache, on utilise la fonction `boxplot()` comme suit:
<br>
`boxplot(variable_√†_mettre_en_y ~ variable_√†_mettre_en_x)`
<br>

Les arguments pour le titre, la couleur et le nom des axes sont les m√™mes que ceux vus dans la partie **3.1**. Si on cherche √† repr√©senter la consommation par unit√© de masse en fonction de l'esp√®ce, on code donc ainsi:
<br>

```{r}
boxplot(data$conso_masse ~ data$espece, col = "aquamarine3", 
        main = "Consommation en fonction des esp√®ces", xlab = "esp√®ces", 
        ylab = "Consommation par unit√© de masse")
```
<br>

Voil√†, vous √™tes arriv√©s √† l'√©tape finale des graphiques! 
<br>

![Alt Text](https://media.giphy.com/media/xT77XWum9yH7zNkFW0/giphy.gif)


